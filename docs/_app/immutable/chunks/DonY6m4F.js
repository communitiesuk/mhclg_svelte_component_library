import"./CWj6FrbW.js";import{p as O,ab as A,f as _,a as D,c as H,F as i,G as f,r as M,s as I,t as P}from"./DAeYpASc.js";import{c as w,a as S,e as W}from"./BAP9DKun.js";import{i as G}from"./BRrZqxBe.js";import{e as y,i as L}from"./DtT6GxuX.js";import{c as q,s as z}from"./BYRFjNIU.js";import{p as J,s as K}from"./CDnlRnBP.js";import{L as N}from"./DFOGAo2i.js";import{S as Q}from"./D3eNeeNp.js";function R(t,e,r,a){t=t.map(u=>({targetY:r(u),y:r(u),height:a(u),datum:u})),t.sort((u,g)=>u.targetY-g.targetY);const n=[];for(const u of t){const g={data:[u]};for(C(g,e),n.push(g);n.length>1&&n[n.length-2].hi>n[n.length-1].lo;){const m=n.pop(),o=n[n.length-1];o.data.push(...m.data),C(o,e)}}return n.map(u=>u.data).flat()}function C(t,e){const r=V(t.data),a=U(t.data,r);t.lo=a-r/2,t.lo<e[0]?t.lo=e[0]:t.lo>e[1]-r&&(t.lo=e[1]-r),t.hi=t.lo+r,b(t.data,t.lo,(n,u)=>{n.y=u})}function U(t,e){const r=[];return b(t,-e/2,(a,n)=>{r.push({val:a.targetY-n,weight:1/a.height})}),X(r)}function b(t,e,r){let a=e;for(const n of t)a+=n.height/2,r(n,a),a+=n.height/2}function V(t){let e=0;for(const r of t)e+=r.height;return e}function X(t){let e=0,r=0;for(const a of t)e+=a.val*a.weight,r+=a.weight;return e/r}var Z=W("<g><g></g><g></g></g>");function ue(t,e){O(e,!0);let r=J(e,"chartBackgroundColor",3,"#fafafa"),a=A([0,e.chartHeight]),n=f(()=>Object.values(e.tieredDataObject).filter(Array.isArray).flatMap(o=>o.filter(s=>s.placeLabel===!0)).filter((o,s,l)=>l.findIndex(d=>d[e.series]===o[e.series])===s).map(o=>({[e.series]:o[e.series],lastY:e.yFunction(o.data[0][e.y])}))),u=f(()=>R(i(n),a,o=>o.lastY,o=>20*Math.ceil(o[e.series].length/15)));var g=w(),m=_(g);y(m,17,()=>Object.keys(e.tieredDataObject),L,(o,s)=>{var l=Z(),d=H(l);q(d,()=>({...e.globalTierParams[i(s)]})),y(d,21,()=>e.tieredDataObject[i(s)],L,(v,c)=>{const h=f(()=>`line-${i(c)[e.series]}`);N(v,K(()=>i(c),{get element(){return i(h)},get tier(){return i(s)},get chartBackgroundColor(){return r()},get lineFunction(){return e.lineFunction},get areaFunction(){return e.areaFunction},get xFunction(){return e.xFunction},get yFunction(){return e.yFunction},get onMouseEnterSeries(){return e.onMouseEnterSeries},get onMouseLeaveSeries(){return e.onMouseLeaveSeries},get onClickSeries(){return e.onClickSeries},get clickedSeries(){return e.clickedSeries},get hoveredSeries(){return e.hoveredSeries},get clickedTier(){return e.clickedTier},get hoveredTier(){return e.hoveredTier},get series(){return e.series},get y(){return e.y},get x(){return e.x},get onMouseEnterMarker(){return e.onMouseEnterMarker},get onMouseLeaveMarker(){return e.onMouseLeaveMarker},get onClickMarker(){return e.onClickMarker},get activeMarkerId(){return e.activeMarkerId}}))}),M(d);var F=I(d);y(F,21,()=>e.tieredDataObject[i(s)],L,(v,c)=>{var h=w(),T=_(h);{var B=k=>{const E=f(()=>{var x;return(x=i(u).find(j=>j.datum[e.series]===i(c)[e.series]))==null?void 0:x[e.y]}),Y=f(()=>`label-${i(c)[e.series]}`);Q(k,{get interactiveLines(){return i(c).interactiveLines},get id(){return i(Y)},get clickedSeries(){return e.clickedSeries},get hoveredSeries(){return e.hoveredSeries},get chartWidth(){return e.chartWidth},get lineFunction(){return e.lineFunction},get dataArray(){return i(c)},get xFunction(){return e.xFunction},get yFunction(){return e.yFunction},get newY(){return i(E)},get onClickSeries(){return e.onClickSeries},get onMouseEnterSeries(){return e.onMouseEnterSeries},get onMouseLeaveSeries(){return e.onMouseLeaveSeries},get labelText(){return e.labelText},get series(){return e.series},get y(){return e.y},get tier(){return i(s)}})};G(T,k=>{i(c).showLabel&&k(B)})}S(v,h)}),M(F),M(l),P(()=>z(l,"id",i(s))),S(o,l)}),S(t,g),D()}export{ue as L};
