import"./CWj6FrbW.js";import{p as le,F as a,G as ie,ab as ce,J as de,s as x,c,t as p,a as ve,r as l,f as N}from"./DAeYpASc.js";import{s as g}from"./oN6NPT6s.js";import{f as m,a as v,c as R}from"./BAP9DKun.js";import{i as F}from"./BRrZqxBe.js";import{e as T,i as j}from"./DtT6GxuX.js";import{b as W,a as ue,s as w}from"./BYRFjNIU.js";import{p as C}from"./CDnlRnBP.js";import{B as me}from"./XE8Cmq_2.js";var _e=m('<div class="color-keys svelte-1jvz53m"> </div>'),fe=m('<div class="legend svelte-1jvz53m"><div>Colour key:</div> <!></div>'),be=m('<th scope="col"><div class="header"><!></div></th>'),pe=m('<td class="govuk-table__cell govuk-table__cell--numeric"> </td>'),ke=m('<td class="govuk-table__cell govuk-table__cell--numeric"> </td>'),ye=m('<td class="govuk-table__cell"> </td>'),ge=m('<tr class="govuk-table__row"></tr>'),he=m('<div class="p-4"><!> <div class="table-container svelte-1jvz53m"><div id="table-caption" class="sticky-caption svelte-1jvz53m"> </div> <table class="govuk-table" data-module="moj-sortable-table"><thead class="govuk-table__head"><tr class="govuk-table__row"></tr></thead><tbody class="govuk-table__body"></tbody></table></div></div>');function qe(E,k){le(k,!0);let P=C(k,"data",3,void 0),O=C(k,"metaData",3,void 0),Q=C(k,"caption",3,void 0),M=C(k,"colourScale",3,void 0),i=ie(()=>[...P()]);function X(t,e){const o=new Set;for(const s of t){if(o.has(s[e]))return!1;o.add(s[e])}return!0}let h=[];for(const t in a(i)[0]){const e=X(a(i),t),o=typeof a(i)[0][t],s={key:t,isUnique:e,dataType:o};h.push(s)}const U=h.filter(t=>t.dataType==="number").map(t=>t.key);let r=ce({column:"sortedColumn",order:"ascending"});function Y(t,e){r.column=t,r.order=e}function Z(){typeof a(i)[0][r.column]=="number"&&(r.order==="ascending"?a(i).sort((t,e)=>t[r.column]-e[r.column]):a(i).sort((t,e)=>e[r.column]-t[r.column])),typeof a(i)[0][r.column]=="string"&&(r.order==="ascending"?a(i).sort((t,e)=>t[r.column].localeCompare(e[r.column])):a(i).sort((t,e)=>e[r.column].localeCompare(t[r.column])))}const G={};for(const t of U){const e=a(i).map(n=>n[t]),o=Math.min(...e),s=Math.max(...e);G[t]={min:o,max:s}}de(i,a(i).map(t=>{const e={...t};for(const o of U){const{min:s,max:n}=G[o],y=(t[o]-s)/(n-s);e[`${o}__normalised`]=y}return e}),!0);function A(t){return`hsl(${120*t}, 100%, 80%)`}function $(t){return`hsl(${120*(1-t)}, 100%, 80%)`}const ee=Object.entries({Good:1,Ok:.5,Bad:0});var S=he(),H=c(S);{var te=t=>{var e=fe(),o=x(c(e),2);T(o,17,()=>ee,j,(s,n)=>{var d=_e(),y=c(d,!0);l(d),p(V=>{W(d,`background-color: ${V??""}`),g(y,a(n)[0])},[()=>A(a(n)[1])]),v(s,d)}),l(e),v(t,e)};F(H,t=>{M()==="On"&&t(te)})}var I=x(H,2),z=c(I),ae=c(z,!0);l(z);var J=x(z,2),D=c(J),K=c(D);T(K,21,()=>h,j,(t,e)=>{var o=be(),s=c(o),n=c(s);me(n,{get textContent(){return O()[a(e).key].shortLabel},buttonType:"table header",onClickFunction:()=>{const d=r.column===a(e).key&&r.order==="ascending"?"descending":"ascending";Y(a(e).key,d),Z()}}),l(s),l(o),p(()=>{ue(o,1,`govuk-table__header ${a(e).dataType==="number"?"govuk-table__header--numeric":""}`,"svelte-1jvz53m"),w(o,"title",O()[a(e).key].explainer),w(o,"aria-sort",r.column!==a(e).key?"none":r.column===a(e).key&&r.order==="descending"?"descending":"ascending")}),v(t,o)}),l(K),l(D);var L=x(D);T(L,21,()=>a(i),j,(t,e)=>{var o=ge();T(o,21,()=>h,j,(s,n)=>{var d=R(),y=N(d);{var V=_=>{var f=R(),q=N(f);{var re=b=>{var u=pe(),B=c(u,!0);l(u),p(ne=>{W(u,`background-color: ${ne??""}`),g(B,a(e)[a(n).key])},[()=>O()[a(n).key].direction==="Higher is better"?A(a(e)[a(n).key+"__normalised"]):$(a(e)[a(n).key+"__normalised"])]),v(b,u)},se=b=>{var u=ke(),B=c(u,!0);l(u),p(()=>g(B,a(e)[a(n).key])),v(b,u)};F(q,b=>{M()==="On"?b(re):b(se,!1)})}v(_,f)},oe=_=>{var f=ye(),q=c(f,!0);l(f),p(()=>g(q,a(e)[a(n).key])),v(_,f)};F(y,_=>{a(n).dataType==="number"?_(V):_(oe,!1)})}v(s,d)}),l(o),v(t,o)}),l(L),l(J),l(I),l(S),p(()=>g(ae,Q())),v(E,S),ve()}export{qe as T};
