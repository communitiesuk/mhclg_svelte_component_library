import"./CWj6FrbW.js";import{p as me,G as le,a9 as pe,u as oe,y as o,t as x,a as ke,s as F,c as b,I as se,z as e,r as p,f as q,D as g,M as te,aq as ae}from"./BQOcVDnD.js";import{t as O,a as _,f as xe,c as V,b as de,s as A}from"./Dp3jeoTR.js";import{i as J}from"./w59L6Jp2.js";import{e as ee,i as be}from"./hy64cfae.js";import{e as je}from"./BjsTKdKz.js";import{a as K,b as Se,s as n,d as ye}from"./CM6Y-JJe.js";import{p as W}from"./Bx8udYmP.js";const Le=(H,j=g,z=g,M)=>{let P=te(()=>ae(M==null?void 0:M(),!1));var u=Je(),X=b(u,!0);p(u),x(()=>{n(u,"id",j()),K(u,1,`gem-c-related-navigation__sub-heading ${(e(P)?"gem-c-related-navigation__sub-heading--other":"")??""}`,"svelte-1eujhij"),n(u,"data-track-count",e(P)?void 0:"sidebarRelatedItemSection"),A(X,z())}),_(H,u)};var Te=O('<li class="gem-c-related-navigation__link svelte-1eujhij"><a> </a></li>'),Oe=(H,j,z)=>{H.preventDefault(),j(z())},we=O('<li class="gem-c-related-navigation__link toggle-wrap svelte-1eujhij" data-module="ga4-event-tracker"><a class="gem-c-related-navigation__toggle svelte-1eujhij" role="button"> </a></li>'),De=O("<a> </a> <!>",1),Ee=O('<li class="gem-c-related-navigation__link gem-c-related-navigation__link--truncated-links svelte-1eujhij"><span aria-live="polite" role="region"></span></li>'),Je=O("<h3> </h3>"),Re=O("<!> <!>",1),Ce=O('<nav class="gem-c-related-navigation__nav-section svelte-1eujhij"><!> <ul class="gem-c-related-navigation__link-list svelte-1eujhij"><!> <!></ul></nav>'),Ge=O('<div data-module="ga4-link-tracker" role="complementary"><!> <!></div>');function Ke(H,j){me(j,!0);const z=(a,t=g,s=g,k=g,i=g,r,h=g)=>{let w=te(()=>ae(r==null?void 0:r(),!1));var c=Te();const d=o(()=>Y(t())),v=o(()=>e(d)?t().url:t().base_path),D=o(()=>t().locale),f=o(()=>ne()?void 0:JSON.stringify({event_name:"navigation",type:"related content",index_section:(h()+1).toString(),index_link:(s()+1).toString(),index_section_count:u().length.toString(),index_total:k().toString(),section:i(),...e(d)&&{external:"true"}}));var l=b(c),S=b(l,!0);p(l),p(c),x(()=>{n(l,"href",e(v)),K(l,1,`govuk-link govuk-link gem-c-related-navigation__section-link ${(e(w)?"govuk-link gem-c-related-navigation__section-link--other":"")??""}`,"svelte-1eujhij"),n(l,"target",e(d)?"_blank":void 0),n(l,"rel",e(d)?"noopener noreferrer external":void 0),n(l,"data-ga4-link",e(f)),n(l,"lang",e(D)),A(S,t().title)}),_(a,c)},M=(a,t=g,s=g,k=g)=>{var i=V();const r=o(()=>t().length-k());var h=q(i);{var w=c=>{var d=we(),v=b(d);n(v,"data-ga4-event",JSON.stringify({event_name:"select_content",type:"related content"})),n(v,"href","#"),v.__click=[Oe,ge,s];var D=b(v,!0);p(v),p(d),x(()=>{n(v,"data-controls",`toggle_${s()}`),n(v,"data-expanded",e(L)[s()]),n(v,"data-toggled-text",`Show ${e(r)??""} more`),n(v,"aria-controls",`toggle_${s()}`),n(v,"aria-expanded",e(L)[s()]),A(D,e(L)[s()]?"Show fewer":`Show ${e(r)} more`)}),_(c,d)};J(h,c=>{e(r)>0&&c(w)})}_(a,i)},P=(a,t=g,s=g,k=g,i,r=g,h=g)=>{let w=te(()=>ae(i==null?void 0:i(),!1));var c=V();const d=o(()=>t().slice(r()));var v=q(c);{var D=f=>{var l=Ee(),S=b(l);ee(S,23,()=>e(d),E=>Y(E)?E.url:E.base_path,(E,T,R)=>{var U=De();const C=o(()=>Y(e(T))),m=o(()=>e(C)?e(T).url:e(T).base_path),G=o(()=>e(T).locale),N=o(()=>e(w)?"govuk-link govuk-link gem-c-related-navigation__section-link govuk-link gem-c-related-navigation__section-link--other-truncated":"govuk-link govuk-link gem-c-related-navigation__section-link gem-c-related-navigation__section-link--inline"),I=o(()=>ne()?void 0:JSON.stringify({event_name:"navigation",type:"related content",index_section:(h()+1).toString(),index_link:(r()+e(R)+1).toString(),index_section_count:u().length.toString(),index_total:t().length.toString(),section:k(),...e(C)&&{external:"true"}}));var y=q(U),ue=b(y,!0);p(y);var he=F(y,2);{var fe=$=>{var re=de();x(()=>A(re,e(R)===e(d).length-2?", and ":", ")),_($,re)};J(he,$=>{e(R)<e(d).length-1&&$(fe)})}x(()=>{n(y,"href",e(m)),K(y,1,ye(e(N)),"svelte-1eujhij"),n(y,"target",e(C)?"_blank":void 0),n(y,"rel",e(C)?"noopener noreferrer external":void 0),n(y,"data-ga4-link",e(I)),n(y,"lang",e(G)),A(ue,e(T).title)}),_(E,U)}),p(S),p(l),x(()=>{n(S,"id",`toggle_${s()}`),K(S,1,`gem-c-related-navigation__toggle-more ${(e(L)[s()]?"":"js-hidden")??""}`,"svelte-1eujhij")}),_(f,l)};J(v,f=>{e(d).length>0&&f(D)})}_(a,c)};let u=W(j,"sections",19,()=>[]),X=W(j,"headingLevel",3,2),ve=W(j,"listTruncateThreshold",3,5),ne=W(j,"disableGa4",3,!1);function Y(a){return"url"in a}let L=le(pe({}));oe(()=>{const a={};for(const t of u())a[t.id]=!1;se(L,a,!0)});function ge(a){a in e(L)&&(e(L)[a]=!e(L)[a])}let Z=le(!1);oe(()=>{se(Z,!0)});const B=o(()=>u().find(a=>a.type==="main"));var Q=Ge(),ie=b(Q);{var _e=a=>{var t=V(),s=q(t);je(s,()=>`h${X()}`,!1,(k,i)=>{let r;x(()=>r=Se(k,r,{id:`related-nav-${e(B).id}`,class:"gem-c-related-navigation__main-heading"},"svelte-1eujhij"));var h=de();x(()=>A(h,e(B).title)),_(i,h)}),_(a,t)};J(ie,a=>{e(B)&&e(B).title&&a(_e)})}var ce=F(ie,2);ee(ce,19,u,a=>a.id,(a,t,s)=>{var k=V();const i=o(()=>e(t).links??[]),r=o(()=>e(t).truncateThreshold??ve()),h=o(()=>!e(t).disableTruncation&&e(i).length>e(r)),w=o(()=>e(t).type==="main"||e(t).type==="other"?"other":"normal"),c=o(()=>(e(t).linkStyle??e(w))==="other"),d=o(()=>{var f;return e(t).subheading??((f=e(B))==null?void 0:f.title)??"Related content"});var v=q(k);{var D=f=>{var l=Ce(),S=b(l);{var E=m=>{Le(m,()=>`related-nav-heading-${e(t).id}`,()=>e(t).subheading??"",()=>e(t).type==="other")};J(S,m=>{(e(t).type==="subheading"||e(t).type==="other")&&m(E)})}var T=F(S,2),R=b(T);ee(R,17,()=>e(i).slice(0,e(h)?e(r):e(i).length),be,(m,G,N)=>{z(m,()=>e(G),()=>N,()=>e(i).length,()=>e(d),()=>e(c),()=>e(s))});var U=F(R,2);{var C=m=>{var G=Re(),N=q(G);M(N,()=>e(i),()=>e(t).id,()=>e(r));var I=F(N,2);P(I,()=>e(i),()=>e(t).id,()=>e(d),()=>e(c),()=>e(r),()=>e(s)),_(m,G)};J(U,m=>{e(h)&&e(Z)&&m(C)})}p(T),p(l),x(()=>{n(l,"aria-labelledby",e(t).type!=="main"?`related-nav-heading-${e(t).id}`:void 0),n(l,"data-module",e(h)?"gem-toggle":void 0)}),_(f,l)};J(v,f=>{e(i).length>0&&f(D)})}_(a,k)}),p(Q),x(()=>K(Q,1,`gem-c-related-navigation govuk-!-display-none-print ${(e(Z)?"govuk-frontend-supported":"")??""}`,"svelte-1eujhij")),_(H,Q),ke()}xe(["click"]);export{Ke as R};
